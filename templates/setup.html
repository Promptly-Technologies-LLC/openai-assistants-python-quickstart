<!-- setup.html -->
{% extends "layout.html" %}

{% block content %}
        <div class="setupContainer">
          {% if status and status_message %}
            <p class="status-message {{ status }}">{{ status_message }}</p>
          {% endif %}
          
          <h1 class="title">{% if assistant_id %}Update Assistant{% else %}Setup Required{% endif %}</h1>

          {% if "API key" in setup_message %}
            <div class="setupForm">
              <p class="setupMessage">{{ setup_message }}</p>
                <form action="{{ url_for('set_openai_api_key') }}" method="POST">
                  <div class="inputWrapper">
                    <input 
                      type="password"
                      name="api_key"
                      placeholder="sk-..."
                      required
                      class="input"
                    >
                  </div>
                  <button 
                    type="submit"
                    class="button"
                  >
                    Save API Key
                  </button>
                </form>
              </div>
          {% else %} {# Covers missing assistant ID or user wants to update #}
              <div class="setupForm">
                <p class="setupMessage">Select tools for your assistant:</p>
                <form action="{{ url_for('create_update_assistant') }}" method="POST">
                  <div class="checkboxGroup">
                    <label>
                      <input type="checkbox" name="tool_types" value="code_interpreter" {% if "code_interpreter" in current_tools %}checked{% endif %}>
                      Code Interpreter
                    </label>
                    <label>
                      <input type="checkbox" name="tool_types" value="file_search" {% if "file_search" in current_tools %}checked{% endif %}>
                      File Search
                    </label>
                    <label>
                      <input type="checkbox" name="tool_types" value="function" {% if "function" in current_tools %}checked{% endif %}>
                      Get Weather (Custom Function)
                    </label>
                  </div>
                  <button 
                    type="submit"
                    class="button"
                  >
                    {% if assistant_id %}Update{% else %}Create{% endif %} Assistant
                  </button>
                </form>
              </div>
          {% endif %}
        </div>
{% endblock %}